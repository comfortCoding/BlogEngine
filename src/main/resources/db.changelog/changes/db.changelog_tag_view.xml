<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    <changeSet author="eyese (generated)" id="1627312272443-26">
        <createView fullDefinition="false" remarks="VIEW" viewName="tags_view">select `tags`.`id` AS `id`,`tags`.`name` AS `name`,(case when (`tags`.`weight` &lt; 0.2) then 0.2 else `tags`.`weight` end) AS `weight` from (select `t`.`id` AS `id`,`t`.`name` AS `name`,(count(`pt`.`post_id`) / ((select (count(`pt`.`post_id`) / (select count(`p`.`id`) from `blogdb`.`posts` `p` where (`p`.`is_active` = 1))) AS `not_normalized` from ((`blogdb`.`posts` `p` join `blogdb`.`post2tag` `pt` on((`p`.`id` = `pt`.`post_id`))) join `blogdb`.`tags` `t` on((`pt`.`tag_id` = `t`.`id`))) where (`p`.`is_active` = 1) group by `t`.`name` order by `not_normalized` desc limit 1) * (select count(`p`.`id`) from `blogdb`.`posts` `p` where (`p`.`is_active` = 1)))) AS `weight` from ((`blogdb`.`posts` `p` join `blogdb`.`post2tag` `pt` on((`p`.`id` = `pt`.`post_id`))) join `blogdb`.`tags` `t` on((`pt`.`tag_id` = `t`.`id`))) where (`p`.`is_active` = 1) group by `t`.`name`) `tags`</createView>
    </changeSet>
</databaseChangeLog>